# Story 1.1: Project Setup & Monorepo Structure

## Status
Done

## Executor Assignment
executor: "@dev"
quality_gate: "@architect"
quality_gate_tools: [lint, typecheck, build]

## Story
**As a** developer,
**I want** to set up the monorepo structure with frontend, backend, and shared folders configured with TypeScript, linting, and build tools,
**so that** I have a solid foundation to develop both client and server code with type safety and consistent code quality.

## Acceptance Criteria
1. Monorepo created at `/squad-playground/` with folders: `frontend/`, `backend/`, `shared/`, `docs/`, `scripts/`
2. Root `package.json` with workspaces configured for `frontend` and `backend`
3. `frontend/package.json` includes: `react@18.2+`, `vite@5+`, `typescript@5+`, `tailwindcss@3+`
4. `backend/package.json` includes: `express@4+`, `socket.io@4+`, `typescript@5+`, `winston@3+`
5. TypeScript configured in both frontend and backend with strict mode enabled
6. ESLint + Prettier configured with shared rules in root
7. `.gitignore` excludes `node_modules/`, `dist/`, `.env`, `docs/artifacts/`
8. `README.md` in root with setup instructions: `npm install && npm run dev`
9. Running `npm run dev` from root starts both frontend (port 5173) and backend (port 3000) in parallel
10. No console errors when running dev servers

## ðŸ¤– CodeRabbit Integration

### Story Type Analysis
**Primary Type**: Deployment/Infrastructure
**Secondary Type(s)**: Configuration
**Complexity**: Low

### Specialized Agent Assignment
**Primary Agents**:
- @dev: Implementation

**Supporting Agents**:
- @architect: Validate monorepo structure matches architecture doc

### Quality Gate Tasks
- [ ] Pre-Commit (@dev): Run before marking story complete
- [ ] Pre-PR (@devops): Run before creating pull request

### CodeRabbit Focus Areas
**Primary Focus**:
- Configuration: tsconfig strict mode, ESLint rules
- Dependencies: Correct versions per PRD spec

**Secondary Focus**:
- Security: No hardcoded secrets
- Structure: Workspace configuration correct

## Tasks / Subtasks

- [x] Task 1: Create monorepo root structure (AC: 1, 2)
  - [x] Create root `package.json` with npm workspaces config
  - [x] Create directories: `frontend/`, `backend/`, `shared/`, `docs/`, `scripts/`, `agents/`
  - [x] Create root `tsconfig.base.json` with shared TS config
  - [x] Create `.eslintrc.js` with shared rules
  - [x] Create `.prettierrc`
  - [x] Create `.env.example` with PORT_FRONTEND=5173, PORT_BACKEND=3000
- [x] Task 2: Setup shared package (AC: related to all)
  - [x] Create `shared/package.json`
  - [x] Create `shared/tsconfig.json` extending base
  - [x] Create `shared/types.ts` with all shared TypeScript types from architecture doc Section 4.3
- [x] Task 3: Setup frontend package (AC: 3, 5)
  - [x] Initialize `frontend/package.json` with React 18, Vite 5, TypeScript 5, Tailwind CSS 3
  - [x] Create `frontend/tsconfig.json` with strict mode
  - [x] Create `frontend/vite.config.ts`
  - [x] Create `frontend/tailwind.config.js` with Matrix color palette from UX spec
  - [x] Create `frontend/index.html`
  - [x] Create `frontend/src/main.tsx` entry point
  - [x] Create `frontend/src/App.tsx` placeholder
  - [x] Create `frontend/src/styles/globals.css` with design tokens from UX spec Section 2
- [x] Task 4: Setup backend package (AC: 4, 5)
  - [x] Initialize `backend/package.json` with Express 4, Socket.io 4, TypeScript 5, Winston 3
  - [x] Create `backend/tsconfig.json` with strict mode
  - [x] Create `backend/nodemon.json`
  - [x] Create `backend/src/index.ts` placeholder entry point
- [x] Task 5: Configure dev scripts and .gitignore (AC: 6, 7, 8, 9)
  - [x] Install `concurrently` in root devDependencies
  - [x] Add root scripts: `dev` (concurrently frontend+backend), `build`, `test`, `lint`, `typecheck`
  - [x] Create `.gitignore` excluding node_modules, dist, .env, docs/artifacts
  - [x] Create `README.md` with setup instructions
- [x] Task 6: Validate everything works (AC: 9, 10)
  - [x] Run `npm install` from root â€” no errors
  - [x] Run `npm run dev` â€” both servers start
  - [x] Frontend accessible at http://localhost:5173
  - [x] Backend accessible at http://localhost:3000
  - [x] No console errors

## Dev Notes

### Architecture Reference
This story implements the monorepo structure defined in `system-architecture.md` Section 8.

**Root package.json workspace config:**
```json
{
  "name": "squad-playground",
  "private": true,
  "workspaces": ["shared", "frontend", "backend"],
  "scripts": {
    "dev": "concurrently \"npm run dev -w backend\" \"npm run dev -w frontend\"",
    "build": "npm run build -w shared && npm run build -w backend && npm run build -w frontend",
    "test": "npm run test -w backend && npm run test -w frontend",
    "lint": "eslint . --ext .ts,.tsx",
    "typecheck": "tsc --noEmit -p frontend/tsconfig.json && tsc --noEmit -p backend/tsconfig.json"
  }
}
```

**shared/types.ts** must include ALL types from architecture doc Section 4.3:
- AgentId, AgentStatus, AgentDefinition, AGENT_DEFINITIONS array
- PipelineStatus, PipelineState, PipelineStep
- ParsedAgentMessage, Task
- WebSocket event types: PipelineUpdateEvent, ApprovalRequiredEvent, PipelineCompleteEvent
- PipelineConfig, DEFAULT_PIPELINE_CONFIG

**Frontend design tokens** from UX spec Section 2 must go in `globals.css`:
- Color palette (35+ CSS custom properties)
- Typography (3 font stacks + type scale)
- Spacing scale (4px base)
- Shadows, z-index, animation tokens

**Tailwind config** must include Matrix palette from PRD Section 3.5:
```css
--matrix-black: #0D0D0D
--matrix-green: #22C55E
--matrix-dark-green: #166534
--matrix-neon: #10B981
--gold: #F59E0B
```

**Agent colors** for Tailwind config:
- master: #8B5CF6, pesquisa: #2563EB, organizador: #059669, solucoes: #F59E0B
- estruturas: #374151, financeiro: #10B981, closer: #DC2626, apresentacao: #EC4899

### Monorepo Location
Create the monorepo as a SUBDIRECTORY of the current project: `/squad-playground/` inside the playcode repo root. This keeps the AIOS framework at the root level and the Squad Playground app nested.

### Testing
- Test file location: `frontend/src/__tests__/`, `backend/tests/`
- Testing frameworks: Jest + Testing Library (frontend), Jest + Supertest (backend)
- For this story: manual validation only (servers start, no errors)

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2026-02-27 | 1.0 | Story created from PRD Epic 1 | River (SM) |

## Dev Agent Record

### Agent Model Used
Claude Sonnet 4.5 (claude-sonnet-4-5-20250929) â€” Dex (Dev Agent)

### Debug Log References
- Port 3000 was in use during first test, killed process and retried successfully
- Both servers confirmed running: Vite 5173, Express 3000

### Completion Notes List
- All 6 tasks completed successfully
- 417 npm packages installed, no blocking errors
- 2 moderate vulnerabilities (dep warnings, non-blocking)
- Both dev servers start correctly with `npm run dev`
- shared/types.ts includes all types from architecture Section 4.3
- globals.css includes all 35+ design tokens from UX spec Section 2
- Tailwind config has full Matrix palette + agent colors

### File List
**Created:**
- `squad-playground/package.json` â€” Root monorepo with workspaces
- `squad-playground/tsconfig.base.json` â€” Shared TypeScript config
- `squad-playground/.eslintrc.js` â€” ESLint shared rules
- `squad-playground/.prettierrc` â€” Prettier config
- `squad-playground/.env.example` â€” Environment template
- `squad-playground/.gitignore` â€” Git ignore rules
- `squad-playground/README.md` â€” Setup instructions
- `squad-playground/shared/package.json` â€” Shared package config
- `squad-playground/shared/tsconfig.json` â€” Shared TS config
- `squad-playground/shared/types.ts` â€” All shared TypeScript types
- `squad-playground/frontend/package.json` â€” Frontend dependencies
- `squad-playground/frontend/tsconfig.json` â€” Frontend TS config (strict)
- `squad-playground/frontend/tsconfig.node.json` â€” Vite TS config
- `squad-playground/frontend/vite.config.ts` â€” Vite configuration
- `squad-playground/frontend/tailwind.config.js` â€” Tailwind with Matrix palette
- `squad-playground/frontend/postcss.config.js` â€” PostCSS for Tailwind
- `squad-playground/frontend/index.html` â€” HTML entry with fonts
- `squad-playground/frontend/src/main.tsx` â€” React entry point
- `squad-playground/frontend/src/App.tsx` â€” Root component placeholder
- `squad-playground/frontend/src/vite-env.d.ts` â€” Vite type declarations
- `squad-playground/frontend/src/styles/globals.css` â€” Design tokens + Tailwind
- `squad-playground/backend/package.json` â€” Backend dependencies
- `squad-playground/backend/tsconfig.json` â€” Backend TS config (strict)
- `squad-playground/backend/nodemon.json` â€” Nodemon config
- `squad-playground/backend/src/index.ts` â€” Express server entry

## QA Results
(to be filled by QA agent)
